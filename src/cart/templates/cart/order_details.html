{% extends 'base.html' %}

{% block BODY %}
  {% block content %}
    <h2>Заказ №{{ order.id }}</h2>
    <p style="font-size:18px;">Оформлен: {{ order.created_at }}</p>

    {% if user.is_superuser %}
      <p style="font-size:18px;">Покупатель: {{ order.user.username }}</p>
      <form method="post">
        {% csrf_token %}  
        <div class="row" style="align-items: center; margin-left: 35%;">
          <div class="col-3">
            <select name="status" class="btn btn-outline-dark dropdown-toggle" style="border: 1px solid; ">
              {% for status in status_list %}
                <option value="{{ status.0 }}">{{ status.1 }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-1">
            <input type="submit" class="btn btn-outline-dark" value="Изменить статус"/>
          </div>
        </div>
      </form>
    {% endif %}

    <p style="font-size:18px;">Статус заказа: {{ order.status }}</p>
    <p style="font-size:18px;">Заказ на сумму: {{ order.total_price }}BYN</p>
    {% if order.description != "" %}
      {% if user.is_superuser %}
        <p style="border-bottom: 1px solid; font-size:18px;">Комментарий к заказу: {{ order.description }}</p>
      {% else %}
        <p style="border-bottom: 1px solid; font-size:18px;">Ваш комментарий к заказу: {{ order.description }}</p>
      {% endif %}
    {% endif %}
    {% for book_in_order in order.books.all %}
    <p style="border-top: 1px solid;">Название книги: {{ book_in_order.book.book_name }}</p>
    <p>Цена книги: {{ book_in_order.book.book_price }}BYN</p>
    <p style="border-bottom: 1px solid;">Количество книг: {{ book_in_order.count }}шт.</p>
             
    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" 
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content" style="margin-top: 30%;">
          <div class="modal-header">
            <h5 class="modal-title" id="staticBackdropLabel" style="color: #212529;">Отмена заказа №{{ order.id }}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div>
              Для отмены заказа свяжитесь с администрацией сайта
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Вернуться</button>
          </div>
        </div>
      </div>
    </div>
      
    
  {% endfor %}
    {% if not user.is_superuser %}
      {% if order.status == "В обработке" %}
        <button type="button" class="btn btn-primary btn-lg" 
          style="background-color: #dc3545; border-color: #dc3545; border-radius: 16px; width: 20%;" 
          data-bs-toggle="modal" data-bs-target="#staticBackdrop">
          Отменить заказ
        </button> 
      {% endif %}
    {% endif %}
  {% endblock %}
{% endblock BODY %}